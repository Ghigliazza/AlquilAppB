<head>

<script src='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.js'></script>
<link href='https://api.mapbox.com/mapbox-gl-js/v2.9.1/mapbox-gl.css' rel='stylesheet' />

</head>	

<div id='map' style='width: 600px; height: 400px;'></div>
<script>
  mapboxgl.accessToken = "<%= Rails.application.credentials.mapbox %>";
  var map = new mapboxgl.Map({
    container: 'map',
    style: 'mapbox:///nico-map/cla8t5s8s004m15t3so6gnqt5',
    center: [<%= current_user.coords_x %>, <%= current_user.coords_y %>],
    zoom: 13
  });

  const marker1 = new mapboxgl.Marker({ color: 'green', rotation: 0, scale: 0.7 })
	.setLngLat([<%= current_user.coords_x %>, <%= current_user.coords_y %>])
	.setPopup(new mapboxgl.Popup().setHTML("<b><%= current_user.name %></b>"))
	.addTo(map);

</script>


<% @carsDisponibles.each do |car| %>

      <%#= render partial: 'search/car_card', locals:{car: car} %>  
 	<script>

  	const marker<%= car.license %> = new mapboxgl.Marker({ color: 'red', rotation: 0, scale: 0.5 })
		.setLngLat([<%= car.coords_x %>, <%= car.coords_y %>])
		.setPopup(new mapboxgl.Popup().setHTML("<b> <%= car.brand %> <%= car.model %> </b>"))
		.addTo(map);
	</script>
<% end %>  




x = <%= current_user.coords_x %>
y = <%= current_user.coords_y %>